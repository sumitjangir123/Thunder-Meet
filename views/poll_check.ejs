<meta http-equiv="Refresh" Content="5">
<style>
    .Progress_Status {
        width: 100%;
        height: 100%;
        transition-duration: 1s;
    }

    .myprogressBar {
        width: 1%;
        height: 100%;
        background-color: #4CAF50;
        text-align: center;
        line-height: 32px;
        color: black;
        transition-duration: 1s;
    }
</style>

<body>
    <!-- basic calculations -->
    <% var x=0 %>
    <% var maxi=0 %>
    <% var opt=1 %>
    <%index=1%>

    <%for(j of poll.choices) {%>

        <%if(1 *j.value > maxi) {%>
            <%maxi= 1 *j.value%>
            <%opt=index%>
        <%}%>
        <%x+= 1*j.value%>
        <%index++%>
    <%}%>

           <div style="width: 100%; text-align: center; display: flex; flex-wrap: wrap;">
                <div style="width: 100%;"class="btn">
                    <span style="font-size: 15px;"><%=poll.title%></span>
    </div>
    <div
        style="border: 1px solid black; align-items: center; width: 100%; display: flex; flex-wrap: wrap; height: auto;">
        <% for(i of poll.choices) {%>
        <div style="border: 1px solid black; width: 100%; display: flex; height: auto;">
            <div style="width: 70%; height: auto;">
                <%=i.content%>
            </div>
            <div style="width: 30%;">
                <div class="Progress_Status" style="overflow:hidden;">
                    <div class="myprogressBar bg-info" style="box-shadow: 0px 2px 10px 5px gray;"><%=((i.value / x)*100).toFixed(2) %>%</div>
                </div>
            </div>
        </div>

        <%}%>
                </div>
            </div>

        
            <div class="btn bg-success" style="width:100%; font-size: 20px;">here option <%=opt%> wins with <%=maxi %> votes</div>

    
</body>


<script> 


    var element = document.getElementsByClassName("myprogressBar");
    for (var i = 0; i < element.length; i++) {
      
            var width=1;
            var x=element[i].innerHTML;
            for(var j=0;j<x.split("%")[0];j++){
                element[i].style.width=width+"%";
                width++;
            }
    }
</script> 